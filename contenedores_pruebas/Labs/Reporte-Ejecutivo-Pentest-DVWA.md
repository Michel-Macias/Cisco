# Informe de Auditoría de Seguridad - DVWA

**Fecha:** 15 de Diciembre de 2025
**Auditor:** Consultor de Seguridad (Tú)
**Cliente:** DVWA Corp (Laboratorio)
**Alcance:** Aplicación Web Principal (http://localhost:8081)

---

## 1. Resumen Ejecutivo
Durante la evaluación de seguridad realizada a la aplicación DVWA, se han identificado **múltiples vulnerabilidades de severidad CRÍTICA**. Estas brechas permiten a un atacante externo tomar el control total del servidor, exfiltrar toda la base de datos de usuarios y comprometer a los clientes que visitan el sitio.

El nivel de riesgo global de la aplicación se clasifica como **CRÍTICO**. Se recomienda una intervención inmediata para remediar los fallos detectados antes de cualquier despliegue en producción.

---

## 2. Resumen de Hallazgos

| ID | Vulnerabilidad | Severidad | Impacto |
| :--- | :--- | :--- | :--- |
| **VULN-01** | Inyección de Comandos (RCE) | **Crítica** | Compromiso total del servidor |
| **VULN-02** | Inyección SQL (SQLi) | **Crítica** | Robo de base de datos completa |
| **VULN-03** | Subida de Archivos Sin Restricción | **Crítica** | Ejecución remota de código (Webshell) |
| **VULN-04** | Cross-Site Scripting (XSS Stored) | **Alta** | Ataque persistente a usuarios |
| **VULN-05** | Credenciales Débiles | **Alta** | Acceso no autorizado a administración |
| **VULN-06** | Local File Inclusion (LFI) | **Alta** | Fuga de información sensible del sistema |
| **VULN-07** | Cross-Site Request Forgery (CSRF) | **Media** | Acciones no autorizadas en nombre del usuario |

---

## 3. Detalles Técnicos y Mitigación

### VULN-01: Inyección de Comandos (RCE)
*   **Descripción:** La aplicación concatena la entrada del usuario directamente en comandos del sistema operativo sin sanitización, permitiendo ejecutar comandos arbitrarios (ej: `; /bin/bash`).
*   **Mitigación:**
    *   **Evitar llamadas al sistema:** Usar funciones nativas del lenguaje siempre que sea posible.
    *   **Validación Estricta:** Si es inevitable usar `system()` o `exec()`, utilizar funciones como `escapeshellarg()` y `escapeshellcmd()` en PHP.
    *   **Principio de Mínimo Privilegio:** Ejecutar el servicio web con un usuario con permisos o restringidos.

### VULN-02: Inyección SQL (SQLi)
*   **Descripción:** Los parámetros de entrada se insertan directamente en las consultas SQL, permitiendo a un atacante manipular la base de datos.
*   **Mitigación:**
    *   **Consultas Preparadas (Prepared Statements):** Es la defensa más efectiva. Parametrizar todas las consultas (ej: usando PDO en PHP).
    *   **ORM:** Utilizar ORMs que gestionen la sanitización automáticamente.

### VULN-03: Subida de Archivos (Unrestricted File Upload)
*   **Descripción:** No se valida el tipo ni el contenido de los archivos subidos. Se permitió subir un script `.php` ejecutable.
*   **Mitigación:**
    *   **Lista Blanca de Extensiones:** Permitir solo `.jpg`, `.png`, etc.
    *   **Renombrado:** Cambiar el nombre del archivo al subirlo para evitar ejecuciones directas.
    *   **Almacenamiento Seguro:** Guardar los archivos fuera del directorio raíz web (`webroot`) o en un servidor de almacenamiento dedicado (S3, Blob Storage) sin permisos de ejecución.

### VULN-04: Cross-Site Scripting (XSS)
*   **Descripción:** La aplicación imprime la entrada del usuario en el navegador sin codificarla, permitiendo la inyección de JavaScript (alertas, robo de cookies).
*   **Mitigación:**
    *   **Context-Aware Output Encoding:** Codificar los caracteres especiales (`<`, `>`, `&`, `"`) en entidades HTML antes de mostrarlos en el navegador (ej: `htmlspecialchars()` en PHP).
    *   **CSP (Content Security Policy):** Implementar cabeceras HTTP que restrinjan el origen de los scripts ejecutables.

### VULN-05: Autenticación Débil
*   **Descripción:** Uso de credenciales por defecto (`admin/password`) y falta de protección contra fuerza bruta.
*   **Mitigación:**
    *   **Política de Contraseñas:** Exigir longitud y complejidad mínima.
    *   **Rate Limiting:** Bloquear IPs tras N intentos fallidos.
    *   **MFA:** Implementar autenticación de doble factor.

### VULN-06: Local File Inclusion (LFI)
*   **Descripción:** La aplicación carga archivos locales basándose en input de usuario vulnerable a *Path Traversal* (`../../`).
*   **Mitigación:**
    *   **Validación de Input:** Usar una lista blanca (switch/case) de archivos permitidos ("page1", "page2").
    *   **Desactivar:** Asegurar `allow_url_include=Off` y `allow_url_fopen=Off` en `php.ini`.

### VULN-07: CSRF
*   **Descripción:** Operaciones críticas (cambio de password) se pueden ejecutar mediante enlaces simples sin validación de intencionalidad.
*   **Mitigación:**
    *   **Tokens Anti-CSRF:** Incluir un token aleatorio y único en cada formulario y validarlo en el servidor al recibir la petición.
    *   **SameSite Cookies:** Configurar las cookies de sesión con el atributo `SameSite=Strict` o `Lax`.

---

## 4. Conclusión
La aplicación evaluada presenta un estado de seguridad deficiente por diseño. Implementar las mitigaciones mencionadas es **obligatorio** para garantizar la confidencialidad, integridad y disponibilidad de los datos.
