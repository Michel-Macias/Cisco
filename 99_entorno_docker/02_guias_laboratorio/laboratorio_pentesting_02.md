# Laboratorio 02: WebGoat & WebWolf

## üéØ Objetivo
Dominar las vulnerabilidades web cl√°sicas y modernas utilizando **WebGoat** como plataforma de entrenamiento y **WebWolf** como servidor de atacante auxiliar. Este laboratorio se centra en la comprensi√≥n profunda del flujo de ejecuci√≥n de los ataques.

## üõ†Ô∏è Entorno
- **V√≠ctima:** WebGoat (Java/Spring Boot) - `http://localhost:8080/WebGoat`
- **Herramienta Auxiliar:** WebWolf (Servidor de correos/archivos atacante) - `http://localhost:9080/WebWolf`
- **Atacante:** Kali Linux (Contenedor `kali-attacker`)

## üìù Registro de Ejercicios

### 1. Cross-Site Scripting (XSS)

#### Introducci√≥n y Conceptos
El XSS permite ejecutar scripts en el navegador de la v√≠ctima. WebGoat divide esto en:
- **Reflected XSS:** El payload viaja en la petici√≥n (URL/Formulario) y el servidor lo devuelve.
- **Stored XSS:** El payload se guarda en el servidor (BD, Logs) y se sirve a futuros visitantes.
- **DOM-based XSS:** La vulnerabilidad est√° en el c√≥digo JavaScript del cliente, no en el servidor.

#### Ejercicio 1: Cross Site Scripting (Reflected)
*Estado: ‚úÖ Completado*

**Objetivo:** Identificar qu√© campo del formulario es vulnerable a XSS Reflejado.

**Pasos:**
1.  Ir a **General > Cross Site Scripting (Reflected)**.
2.  Leeremos que debemos encontrar un campo que refleje el input.
3.  Imagina un escenario de compra: hay campos como tarjeta de cr√©dito, c√≥digo de seguridad, cantidad...
4.  **Prueba de Concepto (PoC):**
    *   Probar input normal en todos los campos (ej: "test").
    *   Observar la respuesta. Si el servidor devuelve "Error en el campo test", es candidato.
    *   Inyectar: `<script>alert('XSS')</script>`.
    *   Si aparece una alerta, ¬°Bingo!

**Resultado Esperado:**
*   Identificar que el campo **Credit Card Number** (o similar dependiendo de la versi√≥n) es el vulnerable.
*   Lograr que salte el `alert()`.

#### Ejercicio 2: Cross Site Scripting (Stored)
*Estado: ‚úÖ Completado*

**Objetivo:** Inyectar un script persistente que afecte a cualquiera que visualice el contenido.

**Contexto:**
A diferencia del reflejado, aqu√≠ nuestro c√≥digo malicioso se guarda en la base de datos del servidor (por ejemplo, en un foro o secci√≥n de comentarios).

**Pasos:**
1.  Navegar a la secci√≥n **Cross Site Scripting (Stored)**.
2.  Buscar donde podemos dejar mensajes o comentarios.
3.  **Prueba de Concepto (PoC):**
    *   Escribir un comentario normal para ver c√≥mo se muestra.
    *   Escribir un comentario malicioso: `<script>alert('Tu has sido hackeado')</script>`.
    *   Enviar el comentario.
4.  **Verificaci√≥n:**
    *   Al enviar, si la aplicaci√≥n recarga la lista de comentarios autom√°ticamente, ¬°Deber√≠a saltar el `alert()`!
    *   Si sales de la p√°gina y vuelves a entrar, el alert deber√≠a saltar OTRA VEZ. Eso es la persistencia.

---
#### Ejercicio 3: DOM-Based XSS (Routing)
*Estado: En Progreso*

**Objetivo:** Encontrar una ruta de "test" olvidada en el c√≥digo JavaScript del cliente (Backbone.js).

**Contexto:**
El XSS basado en DOM ocurre cuando el JavaScript del navegador coge datos de una fuente insegura (como la URL) y los ejecuta. Aqu√≠ buscaremos una configuraci√≥n de ruta que haga precisamente eso.

**Pasos para el An√°lisis:**
1.  Abrir las **Herramientas de Desarrollador** (F12) en el navegador.
2.  Ir a la pesta√±a **Search** (o pulsar `Ctrl+Shift+F`).
3.  Buscar t√©rminos clave como `routes` o `Backbone`.
4.  Buscamos un archivo JavaScript que defina las rutas de la aplicaci√≥n (probablemente llamado `GoatRouter.js` o dentro de los scripts principales).
5.  Identificar una ruta que parezca de prueba (ej: `test/...`).

**Hallazgo:**
Encontramos la siguiente definici√≥n en `GoatRouter.js`:
```javascript
'test/:param': 'testRoute',
```
Esto significa que la aplicaci√≥n escucha la URL terminado en `#test/` y pasa lo que escribamos despu√©s a la funci√≥n `testRoute`.

**Respuesta al reto:** `start.mvc#test/`

#### Ejercicio 4: Explotaci√≥n del DOM-Based XSS
*Estado: En Progreso*

**Objetivo:** Ejecutar la funci√≥n interna `webgoat.customjs.phoneHome()` a trav√©s de la vulnerabilidad.

**Instrucciones espec√≠ficas:**
El ejercicio nos pide que ejecutemos una funci√≥n oculta de WebGoat en lugar de un simple alert. Esta funci√≥n devolver√° un n√∫mero aleatorio en la consola del navegador.

**Pasos:**
1.  Abre las **Herramientas de Desarrollador (F12)** y ve a la pesta√±a **Console**. Mant√©nla abierta.
2.  En una nueva pesta√±a (o en la misma url), introduce la siguiente URL:
    ```
    http://localhost:8080/WebGoat/start.mvc#test/<script>webgoat.customjs.phoneHome()</script>
    ```
    *(Aseg√∫rate de copiarlo tal cual. Si el navegador lo codifica -cambia < por %3C-, intenta escribirlo t√∫ o usar un decodificador, pero Chrome/Firefox modernos suelen manejarlo bien en local).*

3.  Observa la **Consola**. Deber√≠as ver un mensaje de respuesta con un n√∫mero aleatorio (ej: `Phone home said: 123456`).
4.  Copia ese n√∫mero y p√©galo en la respuesta del ejercicio en WebGoat.
